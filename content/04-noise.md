## White Noise

White noise is generated by assigning a random height to each map cell.

<figure>
    <noscript>
        <img src="/img/white-noise-128.png"/>
    </noscript>
    <div id="white-noise-interactive-figure"></div>
</figure>

As you can see it isn't particularly useful for terrain generation because it lacks features and
is rather rough, this is because it has a constant power spectral density meaning that
there are no dominant frequencies or patterns in the signal, it lacks coherence.

What we want is something that more closely approximates how landmasses, mountains, valleys and
other natural terrain features form.

## Periodic Functions: Sine Wave

A sine wave describes a periodic oscillation, a repeating pattern based on a curve.

<figure>
    <noscript>
        <img src="/img/sine-wave-128-50.png"/>
    </noscript>
    <div id="sine-wave-interactive-figure"></div>
</figure>

```c
/**
 * Returns the height based on the product of a sine wave
 * periodic function with the passed frequency applied
 * separately to the x and y axis
 * @param x the x coordinate of the point from 0.0 to 1.0
 * @param y the y coordinate of the point from 0.0 to 1.0
 * @param f the frequency of the sine wave
 * @return the height from 0.0 to 1.0
 */
float sineWaveHeight(float x, float y, float f) {
    return sin(x * f) * sin(y * f) * 0.5 + 0.5;
}
```

```c
int main() {
    int w = 64, h = 64;
    float map[w * h];
    for (int i = 0; i < w; ++i) {
        for (int j = 0; j < h; ++j) {
            float x = (1.0f * i) / w;
            float y = (1.0f * j) / h;
            map[i + j * w] = sineWaveHeight(x, y, 8.0);
        }
    }
}
```

Like the white noise it is equally unsatisfactory for the purposes of terrain generation, giving
us a far too regular a pattern, more akin to a manufactured material and not the natural forms
we would expect from the processes of rock and land formation.

## Pink Noise

We have seen how white noise produces unsatisfactorily patternless noise, and a sine wave gives us
an unsatisfactory repetitive pattern, our next step is pink noise. Pink noise is a type of noise where
the power spectral density is inversely proportional to the frequency
<math><mfrac><mi>1</mi><mi>f</mi></mfrac></math> or
<math><msup><mi>f</mi><mn>-1</mn></msup></math>, as the frequency increases the amplitude decreases, this gives it a much smoother
result than white noise while still giving a natural and irregular noise pattern.

### Diamond-Square

The diamond-square algorithm is a midpoint displacement algorithm and one of the algorithms that can
be used to generate pink noise.

<figure>
    Diagram of diamond square algorithm
</figure>

The diamond-square algorithm works by subdividing the map recursively displacing new points based on
the heights of the points established in prior iterations. The first step is to assign height values
to the corners of the map, these can be random per corner, random for all corners or constant starting
height depending on the kind of result wanted.

These corner heights are then used in the diamond update, to calculate the height of the midpoint of
the map. The midpoint height is the mean height of the four corners plus a random offset, the displacement.
The displacement amount, or amplitude, is determined by the frequency, which in the first iteration is 1,
second iteration is 2, third is 4 and so on.

The height for the points that sit between each pair of corners are now calculated in the square update. The
height of these points are calculated from the pair of corners and the pairs of midpoints surrounding them.
Like the diamond update the height is the mean of the surrounding points plus a random offset scaled by the
frequency. Once complete we now have a new grid to begin our next iteration of the diamond-square algorithm.

<figure>
    <div id="diamond-square-interactive-figure"></div>
</figure>

Now we are starting to get somewhere, with pink noise somewhere around
<math><msup><mi>f</mi><mn>-1</mn></msup></math>
we get something that starts to look like natural terrain. However, there you may notice that subtle ridges
or creases appearing, this is due to the biases present in the way the algorithm perturbs the heights along
a grid. Also the terrain is quite uniform in characteristic across the map and still relatively featureless,
this is because although midpoint displacement gives us coherence it is still homogenous.

In the next post we will be looking at different ways of generating noise using Perlin noise.

[V - Perlin Noise](/perlin-noise)